<link rel="stylesheet" href="style.css" />
<script src="script.js" defer></script>

<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Simulife â€“ Une vie en 15s</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 2rem;
      max-width: 600px;
      margin: auto;
      text-align: center;
      background: #f9f9f9;
    }
    .question, #result, #replay, #share-link {
      margin: 1.5rem 0;
    }
    button {
      margin: 0.5rem;
      padding: 0.6rem 1rem;
      font-size: 1rem;
      cursor: pointer;
    }
    #timer {
      font-weight: bold;
      color: #c00;
      margin-bottom: 1rem;
    }
    .hidden {
      display: none;
    }
  </style>
</head>
<body>

  <h1>Simulife â€“ Ta vie en 15s</h1>
  <p id="timer">15</p>

  <div id="questions"></div>

  <div id="result" class="hidden"></div>

  <div id="replay" class="hidden">
    <button onclick="rejouer()">ğŸ” Rejouer</button>
    <button onclick="partager()">ğŸ“¤ Partager</button>
  </div>

  <div id="share-link" class="hidden">
    <input type="text" id="share-url" style="width:100%" readonly />
  </div>

  <script>
    const questions = [
      { q: "Ã‰tudes ?", opts: ["ğŸ¨ Art", "ğŸ§ª Science", "ğŸ’¼ Business", "âŒ Rien"] },
      { q: "Amour ?", opts: ["â¤ï¸ Passion", "ğŸ’” C compliquÃ©", "ğŸ§˜ Je mâ€™en fous"] },
      { q: "CarriÃ¨re ?", opts: ["ğŸ‘©â€ğŸ’» Tech", "ğŸŒ ONG", "ğŸ’° Start-up", "ğŸ¥ Boulanger"] },
      { q: "Vie sociale ?", opts: ["ğŸ‰ Extrovertie", "ğŸ“š Introspective", "ğŸ‘¤ Solo"] },
      { q: "Habitudes ?", opts: ["ğŸƒ Sportif", "ğŸ• Malbouffe", "ğŸ›ï¸ Flemmard"] }
    ];

    let choix = [];
    let timer = 15;
    let index = 0;
    const timerDisplay = document.getElementById("timer");
    const questionsDiv = document.getElementById("questions");

    function afficherQuestion() {
      if (index >= questions.length) {
        genererResultat();
        return;
      }
      questionsDiv.innerHTML = `<div class="question"><h2>${questions[index].q}</h2></div>`;
      questions[index].opts.forEach(opt => {
        const btn = document.createElement("button");
        btn.textContent = opt;
        btn.onclick = () => {
          choix.push(opt);
          index++;
          afficherQuestion();
        };
        questionsDiv.appendChild(btn);
      });
    }

    function compteARebours() {
      const interval = setInterval(() => {
        timer--;
        timerDisplay.textContent = timer;
        if (timer <= 0) {
          clearInterval(interval);
          genererResultat();
        }
      }, 1000);
    }

    function genererResultat() {
      questionsDiv.innerHTML = '';
      timerDisplay.classList.add("hidden");

      // CrÃ©er un rÃ©sultat "absurde mais logique"
      const [etud, amour, carriere, social, habitude] = choix;
      const annees = Math.floor(Math.random() * 40 + 60);
      const lieu = ["BrÃ©sil", "Islande", "Canada", "Japon", "Maroc"][Math.floor(Math.random()*5)];
      const epilogue = ["Tu nâ€™as jamais fini Game of Thrones.", "Tu as adoptÃ© 3 chats.", "Tu es mort en mangeant une raclette."];
      const resultat = `Tu as vÃ©cu ${annees} ans. Tu as Ã©tudiÃ© ${etud || "dans lâ€™Ã©cole de la vie"}, connu ${amour || "une solitude apaisÃ©e"}, travaillÃ© dans ${carriere || "des trucs chelous"}, et menÃ© une vie ${social || "secrÃ¨te"} avec des habitudes ${habitude || "mystÃ©rieuses"}. Tu as fini au ${lieu}. ${epilogue[Math.floor(Math.random()*epilogue.length)]}`;

      document.getElementById("result").textContent = resultat;
      document.getElementById("result").classList.remove("hidden");
      document.getElementById("replay").classList.remove("hidden");

      localStorage.setItem("simulife_last_result", resultat);
    }

    function rejouer() {
      window.location.href = window.location.pathname;
    }

    function partager() {
      const url = new URL(window.location.href);
      url.searchParams.set("result", encodeURIComponent(localStorage.getItem("simulife_last_result")));
      document.getElementById("share-url").value = url.toString();
      document.getElementById("share-link").classList.remove("hidden");
    }

    // Afficher un rÃ©sultat depuis un lien partagÃ©
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.has("result")) {
      const res = decodeURIComponent(urlParams.get("result"));
      document.getElementById("result").textContent = res;
      document.getElementById("result").classList.remove("hidden");
      document.getElementById("replay").classList.remove("hidden");
      timerDisplay.classList.add("hidden");
    } else {
      afficherQuestion();
      compteARebours();
    }
  </script>

</body>
</html>
